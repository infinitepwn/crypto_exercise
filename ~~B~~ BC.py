from Crypto.Util.number import *
from secret import flag

e = 10
m = bytes_to_long(flag)
noise = getPrime(512)

def gen():
    p = getPrime(512)
    q = getPrime(512)
    n = p * q
    return n

def enc(m, n):
    c = pow(noise*m, e, n)
    return c

n = [gen() for i in range(3)]
c = [enc(m, n[i]) for i in range(3)]

print(f'noise = {noise}')
print(f'n = {n}')
print(f'c = {c}')

'''
noise = 8914603811028460200114629256859103968293296077435066776375275155072882248444472393889943137178511951812641496182964730150075462497990385898698298486906897
n = [95290300511871112608638702127194899089122700859828953210449196754905360499091948779555980373930980460885194719861298247884478506533951474199624755122587922109980919862752373267678464071652354015415250300483492831723825834095406850550384704892079915403030836901346941164509726448815066445708472681211026847529, 162217129873813297060588723794858037581143406060172256183768517197139795151955322673060942758604078429790727718520480317921272067429330053678190151759862481805197940154604735322382014938635747071284727575789048005092740072579599241504207271805203308684202107548498116136730014589938619739698335601826470670081, 85307579108391781929861818247235634380546059691360591986797924270397059598378739801513903319895917609987876162103648731677929247271202952928725109710391005193512516974461787486521773180393936006028695092680998810293605569121708227902010341746774456627336763052747573979444219748703645983757387930424248651259]
c = [41370003993595211390928881895868808510890634692355037114443168119127090437053246706798397592351060270175472960003668039879269350766318783342319905320183049778159146350546720014542333649129132290241951947523994797801411427480194984092165553180929131485912155265996929855856231072203600101453267011130758274442, 43291520322798955636009631977388776275732814048205533563041663605307421605818769495119084771639808297902312648964186241446940706691082887421682999239160524140381788556227929487103743238929219000280874645788963345674659543499220744552595390161195033614306633146520583258544663462337845953866006056695433313164, 46254747420556723802475882544372856504238627862768561763489732642703039223610876618921588636383348945075025845806732880812431348335458611926829343105895161402329661861789198576085111962697212351755067579651031340238264143095114283011469382868562875451766095396311983684100822537799994735116176963357156816653]
'''
